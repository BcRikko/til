---
layout: ../../../layouts/Layout.astro
pubDate: "2024-06-24"
updatedDate: "2024-06-24"
title: "「閉じる」アクションを適切に処理する CloseWatcher API"
author: ダーシノ
description: "CloseWatcherAPIを使うとPCのESCキー、スマホの戻るボタンを押したことを検知して処理できるため、マルチデバイス対応が容易になる。"
tags: ["JavaScript"]
---

import Header from '../../../components/Header.astro'

<Header {...frontmatter} />

[CloseWatcherAPI](https://github.com/WICG/close-watcher)はChrome120で実装されたがdialog要素との関係で一時無効化されたが、Chrome126で復活した。

※2024-06-24時点では、Chrome126、Edge126でのみ利用可能（[CanIUse](https://caniuse.com/mdn-api_closewatcher)）

PCのESCキー、スマホの戻るボタンを押したことを検知して処理できるため、マルチデバイス対応が容易になる。

```ts
const watcher = new CloseWatcher()

watcher.addEventListener('cancel', e => /* キャンセルアクションをしたとき */)
watcher.addEventListener('close', e => /* 閉じるアクションをしたとき */)
```
